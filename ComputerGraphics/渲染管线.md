# 渲染管线

渲染管线是指一堆图形数据，经过一系列处理流程后，展现在屏幕上的过程

### 总体流程

<img width="951" height="615" alt="image" src="https://github.com/user-attachments/assets/4d397ad0-ab98-4d54-983c-3a4b0c658de9" />

概述：
1. 首先输入是3D物体的顶点和顶点的连接关系
2. 将顶点经过MVP，映射到屏幕空间
3. 顶点连接形成三角形
4. 光栅化，采样三角形内部的点，形成不同的像素
5. 深度计算
6. 着色
7. 渲染


### 顶点处理

1. 顶点处理可以进行顶点着色
2. 属于可编程管线

### 问题：为什么是顶点处理而不是三维物体处理？

> 因为三维物体也是由顶点组成，顶点之间的连线可以在屏幕空间连接

> 待补充 是不是可以节省性能？

### 像素点处理

进行逐像素着色，同时此处属于可编程管线``Pixel Shader``

### Shader

用于编程控制每一个顶点、像素点如何着色

<img width="925" height="675" alt="image" src="https://github.com/user-attachments/assets/838aa652-5519-4294-85b4-8923d1801c40" />

### 渲染管线

细分为四个阶段：

应用程序阶段-几何处理阶段-光栅化阶段-像素处理阶段

### 应用程序阶段(CPU处理)

将可见的网格以及其材质，并且送至GPU处理（包括可见性判断）

> 图形硬件GPU核心多，擅长处理图形，适合做浮点数运算，适合做海量数据的相同操作的并行计算，CPU适合处理少量数据的复杂逻辑

### 几何处理阶段(GPU)

处理多边形和顶点，将三维空间的数据转到二维空间，处理包括：
1. 顶点着色
2. 投影变换
3. 裁剪
4. 屏幕空间映射

顶点处理阶段(着色器完全可控)：

1. 顶点变换-通过MVP矩阵将顶点变换到裁剪空间中的位置
2. 顶点着色-如果是平面着色或者是顶点着色，则会发生在该阶段


